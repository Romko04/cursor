/* Source and licensing information for the line(s) below can be found at https://www.choicenotchance.org.nz/sites/all/modules/sparks/cnc_lotto/js/tool.js. */
(function($){Drupal.behaviors.lotto={attach:function(context,settings){var Attempts=0,App=$(".lotto-tool",context),Max=settings.cnc_lotto.lotto_odds,Min=0,Victory=Math.floor(Math.random()*(Max-Min+1))+Min===1?true:false,Timer,Timer2,Clock={powerball:{interval:settings.cnc_lotto.powerball_odds,elapse:settings.cnc_lotto.powerball_time},lotto:{interval:settings.cnc_lotto.lotto_odds,elapse:settings.cnc_lotto.lotto_time}},isEdge=(navigator.userAgent.indexOf("Edge")>-1||navigator.userAgent.indexOf("Trident/7.0")>-1)?true:false,ev=$('html').hasClass('touch')?'touchstart':'click';if($("#js-inject-block").length)$(".block--cnc-lotto",context).detach().appendTo('#js-inject-block');var UI={scenes:$(".lotto-tool__scene",App),next:$(".next",App),go:$(".lotto-tool__button.go",App),stop:$(".lotto-tool__button.stop",App),hands:document.getElementsByTagName('animateTransform'),calendar:{day:$(".lotto-tool__calendar > .day",App),month:$(".lotto-tool__calendar > .month",App)},clock:{hour:$("#hour-hand",App),min:$("#minute-hand",App)},enlarge:$("<button />",{'class':'lotto-tool__util-button lotto-tool__enlarge',text:'Fullscreen',type:'button'}),share:$("<button />",{'class':'lotto-tool__util-button lotto-tool__share',text:'Share on facebook',type:'button'}),shareText:'To understand the odds of winning Lotto, itâ€™s easier for us play a train game'};UI.next.on(ev,_nextScreen);$(".lotto-tool__scene-1",App).find(UI.next).on('click',function(e){var competition=$(this).attr('data-competition');App.attr('data-competition',competition);$(".lotto-tool__calendar,.lotto-tool__daily",App).removeClass('js-fadeout')});App.addClass('js-ready').append(UI.enlarge).append(UI.share).wrap('<div class="cnc-lotto-original-position" />');UI.enlarge.on('click',function(e){App.toggleClass('fullscreen');if(App.hasClass('fullscreen')){App.detach().appendTo('body')}else App.detach().appendTo('.cnc-lotto-original-position');e.preventDefault()});Victory?$(".lotto-tool__scene-4",App).addClass('victorious'):$(".lotto-tool__result[data-for='success']",App).remove();setTimeout(function(){$(".lotto-tool__scene-1",App).addClass('active');if(isEdge)App.addClass('msedge')},100);UI.go.on(ev,_startTrain);UI.stop.on(ev,_stopTrain);var _clock_powerball={start:new Date("January 1, 2017 00:00:00"),end:new Date("January 1, 2017 00:00:00"),init:function(){this.start=new Date("January 1, 2017 00:00:00");this.end=new Date("January 1, 2017 00:00:00");this.end.setSeconds(this.start.getSeconds()+Clock.powerball.interval);this.setDate(this.start.getDate());this.setMonth(this.start.getMonth())},setDate:function(day){day=day>9?day:'0'+day;UI.calendar.day.text(day)},setMonth:function(month){var months=['Jan','Feb'];month=months[month];UI.calendar.month.text(month)},update:function(){this.setDate(this.start.getDate());this.setMonth(this.start.getMonth())},finish:function(){this.setDate(this.end.getDate());this.setMonth(this.end.getMonth())}};_clock_powerball.init();var _clock_lotto={start:new Date("January 1, 2017 00:00:00"),end:new Date("January 1, 2017 00:00:00"),init:function(){this.start=new Date("January 1, 2017 00:00:00");this.end=new Date("January 1, 2017 00:00:00");this.end.setSeconds(this.start.getSeconds()+Clock.lotto.interval);this.setDay(this.start.getDay());this.setTime(this.start.getHours(),this.start.getMinutes())},setDay:function(day){var days=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],day=days[day];$(".day",".lotto-tool__daily").text(day)},setTime:function(hour,min){hour=hour>9?hour:'0'+hour;min=min>9?min:'0'+min;$(".time",".lotto-tool__daily").text(hour+':'+min)},update:function(){this.setDay(this.start.getDay());this.setTime(this.start.getHours(),this.start.getMinutes())},finish:function(){this.setDay(this.end.getDay());this.setTime(this.end.getHours(),this.end.getMinutes())}};_clock_lotto.init();UI.share.on(ev,function(e){$('<meta />',{property:'og:title',content:'Choicenotchance.org.nz Pokies Tool'}).appendTo('head');$('<meta />',{property:'og:description',content:UI.shareText}).appendTo('head');window.open("https://www.facebook.com/sharer.php?u="+escape(window.location.href),'Choicenotchance.org.nz Pokies Tool',"toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=yes,width=580,height=380")})
function _nextScreen(e){var active=$(".lotto-tool__scene.active",App),next=active.next().hasClass("lotto-tool__scene")?active.next():$(".lotto-tool__scene:first-child",App);active.removeClass('active');next.addClass('active');if(e)e.preventDefault()}
function _startTrain(e){App.addClass('animating');if(!isEdge){UI.hands[0].beginElement();UI.hands[1].beginElement()};UI.stop=$(".lotto-tool__button.stop",".lotto-tool.animating");var competition=App.attr('data-competition');_clock(Clock[competition].elapse);var hour_rotations=((Clock[competition].interval/86400)*2),min_rotations=((Clock[competition].interval/86400)*24),hour_rotations_speed=Clock[competition].elapse/hour_rotations;UI.clock.hour.attr('dur',hour_rotations_speed.toFixed(2)+'s');var min_rotations_speed=Clock[competition].elapse/min_rotations;UI.clock.min.attr('dur',min_rotations_speed.toFixed(2)+'s');$('<style>.animating .lotto-tool__scene-3::before{animation-duration:'+(hour_rotations_speed*2).toFixed(2)+'s}</style>').appendTo('head');$('<style>.animating .lotto-tool__planets {animation-duration:'+(hour_rotations_speed*2).toFixed(2)+'s}</style>').appendTo('head');$('<style>.animating .lotto-tool__planets svg {animation-duration:'+(hour_rotations_speed*2).toFixed(2)+'s}</style>').appendTo('head');$('<style>.animating .lotto-tool__scene-3 *[data-window-r] {animation-duration:'+(hour_rotations_speed*2).toFixed(2)+'s!important}</style>').appendTo('head');$('<style>.animating .lotto-tool__scene-3 *[data-window-l] {animation-duration:'+(hour_rotations_speed*2).toFixed(2)+'s!important}</style>').appendTo('head');$('<style>.animating .lotto-tool__scene-3 *[data-window-m] {animation-duration:'+(hour_rotations_speed*2).toFixed(2)+'s!important}</style>').appendTo('head');_counter(competition);if(e)e.preventDefault()}
function _clock(sec){if(Timer)clearInterval(Timer);Timer=setInterval(function(){sec--;if(sec==-1){clearInterval(Timer);_stopTrain()}},1e3)}
function _counter(competition){var props=Clock[competition],ms=props.elapse*1e3,clock=competition=='powerball'?_clock_powerball:_clock_lotto,seconds=(clock.end-clock.start)/1e3,seconds_per_millisecond=seconds/ms,interval=100,seconds_per_interval_milliseconds=seconds_per_millisecond*interval,max_loops=ms/interval,i=0;if(Timer2)clearInterval(Timer2);Timer2=setInterval(function(){if(i<=max_loops){clock.update();var m=clock.start.getSeconds()+seconds_per_interval_milliseconds;clock.start.setSeconds(m);i++}else{clock.finish();$(".lotto-tool__daily,.lotto-tool__calendar",App).addClass('js-fadeout')}},interval)}
function _stopTrain(e){clearInterval(Timer);clearInterval(Timer2);App.removeClass('animating').addClass('stopped');if(!isEdge){UI.hands[0].endElement();UI.hands[1].endElement()};_nextScreen();_clock_lotto.init();_clock_powerball.init();if(Attempts>1)App.addClass('util-nav-is-revealed');Attempts++;if(e)e.preventDefault()}}}})(jQuery);;
/* Source and licensing information for the above line(s) can be found at https://www.choicenotchance.org.nz/sites/all/modules/sparks/cnc_lotto/js/tool.js. */
;/*})'"*/
